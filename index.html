<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pokedex</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #fff;
  }

  .search-container {
    display: flex;
    justify-content: center;
    padding: 20px;
  }

  .search-container input {
    width: 90%;
    max-width: 500px;
    padding: 10px 15px;
    border: 2px solid #000;
    border-radius: 25px;
    font-size: 16px;
    outline: none;
  }

  .pokemon-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    padding: 10px;
  }

  .pokemon-card {
    width: 250px;
    height: 120px;
    border-radius: 15px;
    display: flex;
    align-items: center;
    position: relative;
    color: #fff;
    font-weight: bold;
    text-align: center;
    padding-left: 10px;
    box-sizing: border-box;
    opacity: 0;
    transition: opacity 0.3s;
    cursor: pointer;
  }

  .pokemon-card.show {
    opacity: 1;
  }

  .pokemon-card img.pokemon-img {
    width: 100px;
    height: 100px;
    margin-right: 10px;
  }

  .pokemon-number {
    position: absolute;
    top: 5px;
    left: 10px;
    font-size: 14px;
  }

  .pokemon-types {
    position: absolute;
    top: 5px;
    right: 25px;
    display: flex;
    gap: 3px;
  }

  .pokemon-type-img {
    width: 15px;
    height: 15px;
  }

  .detail-box {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(0,0,0,0.85);
    color: #fff;
    padding: 10px;
    border-radius: 10px;
    max-width: 180px;
    text-align: left;
    display: none;
    z-index: 10;
  }

  .detail-box h4 {
    margin: 0 0 5px 0;
    font-size: 14px;
  }

  .detail-box p {
    margin: 2px 0;
    font-size: 12px;
  }

  .close-btn {
    position: absolute;
    top: 2px;
    right: 2px;
    background: red;
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 12px;
    cursor: pointer;
  }

  @media (max-width: 600px) {
    .pokemon-card {
      width: 200px;
      height: 100px;
      padding-left: 5px;
    }

    .pokemon-card img.pokemon-img {
      width: 70px;
      height: 70px;
    }

    .pokemon-type-img {
      width: 12px;
      height: 12px;
    }

    .detail-box {
      max-width: 140px;
      font-size: 11px;
    }
  }
</style>
</head>
<body>

<div class="search-container">
  <input type="text" id="search" placeholder="Digite o nome do Pokémon...">
</div>

<div class="pokemon-container" id="pokemon-container">
  <!-- Cards serão inseridos aqui -->
</div>

<script>
const container = document.getElementById('pokemon-container');
const searchInput = document.getElementById('search');
const totalPokemons = 150;
const allPokemons = [];

const typeColors = {
  normal: "#A8A77A",
  fire: "#EE8130",
  water: "#6390F0",
  electric: "#F7D02C",
  grass: "#7AC74C",
  ice: "#96D9D6",
  fighting: "#C22E28",
  poison: "#A33EA1",
  ground: "#E2BF65",
  flying: "#A98FF3",
  psychic: "#F95587",
  bug: "#A6B91A",
  rock: "#B6A136",
  ghost: "#735797",
  dragon: "#6F35FC",
  dark: "#705746",
  steel: "#B7B7CE",
  fairy: "#D685AD"
};

function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

async function fetchPokemon(id) {
  try {
    const res = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
    const data = await res.json();
    return data;
  } catch (err) {
    console.error(err);
  }
}

async function fetchPokemonSpecies(id) {
  try {
    const res = await fetch(`https://pokeapi.co/api/v2/pokemon-species/${id}`);
    const data = await res.json();
    return data;
  } catch(err) {
    console.error(err);
  }
}

function createPokemonCard(pokemon) {
  const card = document.createElement('div');
  const primaryType = pokemon.types[0].type.name;
  card.classList.add('pokemon-card');
  card.style.backgroundColor = typeColors[primaryType] || "#777";

  const number = document.createElement('div');
  number.classList.add('pokemon-number');
  number.textContent = `#${pokemon.id.toString().padStart(3,'0')}`;
  card.appendChild(number);

  const typesContainer = document.createElement('div');
  typesContainer.classList.add('pokemon-types');
  pokemon.types.forEach(t => {
    const img = document.createElement('img');
    img.src = `https://raw.githubusercontent.com/duiker101/pokemon-type-svg-icons/master/icons/${t.type.name}.svg`;
    img.classList.add('pokemon-type-img');
    typesContainer.appendChild(img);
  });
  card.appendChild(typesContainer);

  const img = document.createElement('img');
  img.src = pokemon.sprites.other['official-artwork'].front_default;
  img.alt = pokemon.name;
  img.classList.add('pokemon-img');
  card.appendChild(img);

  const name = document.createElement('div');
  name.textContent = capitalize(pokemon.name);
  card.appendChild(name);

  // Caixa de detalhes
  const detailBox = document.createElement('div');
  detailBox.classList.add('detail-box');
  card.appendChild(detailBox);

  const closeBtn = document.createElement('button');
  closeBtn.classList.add('close-btn');
  closeBtn.textContent = "X";
  closeBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    detailBox.style.display = 'none';
  });
  detailBox.appendChild(closeBtn);

  // Clique abre descrição detalhada
  card.addEventListener('click', async () => {
    detailBox.innerHTML = '';
    detailBox.appendChild(closeBtn);
    detailBox.style.display = 'block';
    const species = await fetchPokemonSpecies(pokemon.id);
    const flavor = species.flavor_text_entries.find(f => f.language.name === "en")?.flavor_text.replace(/\n|\f/g, ' ') || "Sem descrição.";
    
    // Simula level e raridade baseado no id
    const level = Math.min(100, Math.floor(pokemon.id/10)+1);
    const rarity = ["Common","Uncommon","Rare","Epic","Legendary"][Math.floor(pokemon.id/300*5)] || "Common";

    detailBox.innerHTML += `<h4>${capitalize(pokemon.name)}</h4>`;
    detailBox.innerHTML += `<p><strong>Level:</strong> ${level}</p>`;
    detailBox.innerHTML += `<p><strong>Rarity:</strong> ${rarity}</p>`;
    detailBox.innerHTML += `<p>${flavor}</p>`;
    detailBox.appendChild(closeBtn);
  });

  container.appendChild(card);

  setTimeout(() => card.classList.add('show'), 50);
}

async function loadPokemons() {
  for (let i = 1; i <= totalPokemons; i++) {
    const pokemon = await fetchPokemon(i);
    allPokemons.push(pokemon);
    createPokemonCard(pokemon);
    await new Promise(res => setTimeout(res, 30));
  }
}

searchInput.addEventListener('input', () => {
  const value = searchInput.value.toLowerCase();
  container.innerHTML = '';
  allPokemons
    .filter(p => p.name.includes(value))
    .forEach(p => createPokemonCard(p));
});

loadPokemons();
</script>

</body>
</html>
